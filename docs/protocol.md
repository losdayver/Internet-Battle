# Описание протокола игры

## Каждый пакет представляет собой json объект и обязательно содержит следующие свойства:
- **type** - строковое поле, описывающее тип пакета
- **<заголовки пакета>** - уникальны для каждого пакета

## Пакеты клиент -> сервер:

Запрос на подключение к серверу. Клиент должен передать свое имя в свойстве "name":
```json
{
    "type": "connection",
    "action": "connect",
    "name": "<имя игрока>"
}
```

Дисконнект:
```json
{
    "type": "connection",
    "uid": <uid>,
    "action": "disconnect",
}
```

Запрос отключение от сервера. Клиент должен передать свой uid:
```json
{
    "uid" : "<уникальный идентификатор пользователя>" ,
    "type": "connection",
    "action": "disconnect"
}
```

Отправка нажатых и отпущенных клавиш:
```json
{
    "uid": "<уникальный идентификатор пользователя>",
    "type": "input",
    "pressed": [<Список нажатых клавиш>],
    "released": [<Список нажатых клавиш>]
}
```

Отправка сообщения:
```json
{
    "uid": uid,
    "type": "message",
    "text": text
}
```

## Пакеты сервер -> клиент:

Подтверждение принятия клиента в игровую комнату:
```json
{
    "type": "connection",
    "action": "accept",
    "uid": "<уникальный идентификатор пользователя>"
}
```

Запрос клиента о подключении был принят, но сервер отказался принимать клиента в комнату:
```json
{
    "type": "connection",
    "action": "reject",
    "reason": "<причина отказа>"
}
```

Отправка сообщений чата:
```json
{
    "type": "chat_data",
    "messages": [
        {"author": "<имя1>", "text": "<текст сообщения>"},
        {"author": "<имя2>", "text": "<текст сообщения>"},
        {"author": "<имя3>", "text": "<текст сообщения>"},
        {"author": "<имя1>", "text": "<текст сообщения>"}
    ]
}
```

**[обсуждается]**
Отправка информации о текущем состоянии комнаты
```json
{
    "type": "scene_data",
    "static": "map1.json",
    "dynamic": {
      "append": [{
            "type": "box1",
            "id": 1,
            "position": [5, 5],
            "vector": [0.0, 0.1]
        }],
      "remove": [{
        "type": "all"
      }]
  }
}
```